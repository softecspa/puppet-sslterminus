# File Managed by Puppet 
user <%= scope.lookupvar('nginx::daemon_user') %>;
worker_processes 2;

error_log  <%= scope.lookupvar('nginx::logdir')%>/error.log;
pid        <%= scope.lookupvar('nginx::pid')%>;

events {
  worker_connections 2048;
  <% if scope.lookupvar('nginx::multi_accept') == 'on' %>multi_accept on;<% else %>multi_accept off;<% end %>
}

http {
  include       <%= scope.lookupvar('nginx::conf_dir')%>/mime.types;
  default_type  application/octet-stream;

  geo $from_softec {
    default 0;
<% subnet_softec.split(' ').each do |net| -%>
    <%= net %> 1;
<% end -%>
  }

  sendfile    on;
  tcp_nopush  on;
  tcp_nodelay        off;
  keepalive_timeout  <%= scope.lookupvar('nginx::keepalive_timeout')%>;

  types_hash_max_size 2048;
  server_names_hash_bucket_size 64;
  types_hash_bucket_size 64;
  underscores_in_headers on;

  gzip         <%= scope.lookupvar('nginx::gzip')%>;
  gzip_disable "MSIE [1-6]\.(?!.*SV1)";

  include <%= scope.lookupvar('nginx::conf_dir') %>/conf.d/*.conf;
  include <%= scope.lookupvar('nginx::conf_dir') %>/sites-enabled/*;
}
